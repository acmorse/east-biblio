<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-07-25 Thu 15:14 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>README for EAST bibliographic records</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Patrick McAllister (pma@rdorte.org)" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">README for EAST bibliographic records</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org5096187">1. Layout of this repository</a>
<ul>
<li><a href="#org1e7316e">1.1. Jabref hints</a></li>
</ul>
</li>
<li><a href="#org0c712f7">2. General workflow</a>
<ul>
<li><a href="#org3031a7e">2.1. Guidelines for adding/updating entries</a></li>
</ul>
</li>
<li><a href="#org45a8ed3">3. Git useful commands</a>
<ul>
<li><a href="#org97844c4">3.1. Check status</a></li>
<li><a href="#org8b4d321">3.2. To save local changes</a></li>
<li><a href="#org36e7787">3.3. To share things</a></li>
</ul>
</li>
<li><a href="#org2acfbae">4. Bibliography processing</a>
<ul>
<li><a href="#org8c746b6">4.1. MODS -&gt; bib(la)tex</a></li>
<li><a href="#org046315f">4.2. biblatex -&gt; MODS</a></li>
</ul>
</li>
<li><a href="#org1c734a9">5. Database/Django commands</a></li>
</ul>
</div>
</div>
<p>
This repository contains the bibliographic data for EAST
(<a href="https://east.ikga.oeaw.ac.at">https://east.ikga.oeaw.ac.at</a>).
</p>

<p>
The “official” repository URL is:
git@gitlab.com:east-bibliography/bibdata.git
</p>

<p>
The admin of that repository is Patrick McAllister.  The repository is
private, which means that to push or pull you will need to register on
gitlab, and then ask the admin to add you to the group.
</p>


<div id="outline-container-org5096187" class="outline-2">
<h2 id="org5096187"><span class="section-number-2">1</span> Layout of this repository</h2>
<div class="outline-text-2" id="text-1">
<p>
The most important files are:
</p>

<ol class="org-ol">
<li>README.org (this file)</li>
<li><a href="./bib/east.bib">./bib/east.bib</a>: A single BibLaTeX file, to be edited by a
program of choice (e.g., <a href="http://www.jabref.org/">http://www.jabref.org/</a>)</li>
<li>Whichever you use, make sure that you’re using a “biblatex” editing
mode (Jabref: Options -&gt; Preferences -&gt; General -&gt; Default
bibliography mode -&gt; “BiBLaTeX”, for example)</li>
</ol>

<p>
Other directories contain files that should not be edited, normally.
They contain automatically generated content (pulled from EAST’s
database), and the content is subject to change.
</p>

<ol class="org-ol">
<li><a href="./archived">./archived</a>: contains all the bibliographic data in a
normalized (mods) xml format</li>
<li><a href="./archived/sources">./archived/sources</a>: this directory contains all the
bibliographic sources, in the raw format (they are not all MODS
files).</li>
</ol>
</div>


<div id="outline-container-org1e7316e" class="outline-3">
<h3 id="org1e7316e"><span class="section-number-3">1.1</span> Jabref hints</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Here are some useful things to know about jabref:
</p>

<ol class="org-ol">
<li><b>Use the search/filter function</b>: read
<a href="https://help.jabref.org/en/Search">https://help.jabref.org/en/Search</a>. It’s somewhat obvious, but
remember you can easily search for fields:
<ol class="org-ol">
<li><code>journal = chizan</code>, or <code>keywords=canonical</code>, etc.</li>
<li>Combine them: <code>keywords=canonical and title = tshad</code></li>
<li>For “spaces” in the search string, use quotes: <code>keywords =
      canonical and translator = "zha ma"</code></li>
<li>Empty fields: <code>author != .+</code></li>
</ol></li>
<li>Linking to east: Take the numerical part of the bib_id (e.g.,
<code>27507</code> in <code>east:27507</code>), and add it to
<a href="https://east.ikga.oeaw.ac.at/bib/">https://east.ikga.oeaw.ac.at/bib/</a> (e.g.:
<a href="https://east.ikga.oeaw.ac.at/bib/27507">https://east.ikga.oeaw.ac.at/bib/27507</a>)</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org0c712f7" class="outline-2">
<h2 id="org0c712f7"><span class="section-number-2">2</span> General workflow</h2>
<div class="outline-text-2" id="text-2">
<p>
Before starting to edit anything, <b>always</b> make sure your repository
is up to date. You can do this with
</p>

<ul class="org-ul">
<li><code>git status</code>: checks for local changes</li>
<li><code>git pull</code>: gets updates from the remote repositories</li>
</ul>

<p>
After you have finished your work, adding or changing entries, you
will usually want to share your changes, typically:
</p>

<ol class="org-ol">
<li><code>git commit</code>: add a short message describing what you did</li>
<li><code>git push</code>: send changes to central repository</li>
</ol>

<p>
The overall aim is then to add or update an entry in the main
bibliographic file, <a href="./bib/east.bib">./bib/east.bib</a>
</p>
</div>

<div id="outline-container-org3031a7e" class="outline-3">
<h3 id="org3031a7e"><span class="section-number-3">2.1</span> Guidelines for adding/updating entries</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>We follow the BibLaTeX standards, as described in Chapter 2
(“Database Guide”) of
<a href="http://tug.ctan.org/macros/latex/exptl/biblatex/doc/biblatex.pdf">http://tug.ctan.org/macros/latex/exptl/biblatex/doc/biblatex.pdf</a>,
with <b>the following additional rule(s)</b>:
<ul class="org-ul">
<li><p>
Bibliographic entries that contain data fields in multiple
languages or scripts need to have the following format:
<code>transcribed-title-or-name [*translated title or name]</code>.  For example:
</p>
<pre class="example">
title = {Ninshikiron: chikaku no riron to sono tenkai [*Epistemology: the Theory of Perception and its Development]},
</pre>
<p>
Note that in such cases we do not use Biblatex’s <code>subtitle</code> field!
</p></li>
</ul></li>
<li>We use unicode encoding in the bib file.</li>
</ul>
</div>
</div>
</div>


<div id="outline-container-org45a8ed3" class="outline-2">
<h2 id="org45a8ed3"><span class="section-number-2">3</span> Git useful commands</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org97844c4" class="outline-3">
<h3 id="org97844c4"><span class="section-number-3">3.1</span> Check status</h3>
<div class="outline-text-3" id="text-3-1">
<ol class="org-ol">
<li>To see what has changed: <code>git status</code></li>
<li>To see differences: <code>git diff</code></li>
</ol>
</div>
</div>


<div id="outline-container-org8b4d321" class="outline-3">
<h3 id="org8b4d321"><span class="section-number-3">3.2</span> To save local changes</h3>
<div class="outline-text-3" id="text-3-2">
<ol class="org-ol">
<li><code>git commit -a</code> (commits all changes locally)</li>
</ol>
</div>
</div>


<div id="outline-container-org36e7787" class="outline-3">
<h3 id="org36e7787"><span class="section-number-3">3.3</span> To share things</h3>
<div class="outline-text-3" id="text-3-3">
<ol class="org-ol">
<li>Get latest version: <code>git pull</code></li>
<li>Upload local version (if committed): <code>git push</code></li>
</ol>

<p>
2019.03.08
</p>
</div>
</div>
</div>






<div id="outline-container-org2acfbae" class="outline-2">
<h2 id="org2acfbae"><span class="section-number-2">4</span> Bibliography processing</h2>
<div class="outline-text-2" id="text-4">
<ul class="org-ul">
<li>Install bibutils (<a href="https://sourceforge.net/p/bibutils/home/Bibutils/">https://sourceforge.net/p/bibutils/home/Bibutils/</a>)</li>
</ul>
</div>

<div id="outline-container-org8c746b6" class="outline-3">
<h3 id="org8c746b6"><span class="section-number-3">4.1</span> MODS -&gt; bib(la)tex</h3>
<div class="outline-text-3" id="text-4-1">
<div class="org-src-container">
<pre class="src src-bash">parallel xml2bib <span style="color: #8b2252;">\</span>
         --output-encoding unicode <span style="color: #8b2252;">\</span>
         --no-bom <span style="color: #8b2252;">\</span>
         --whitespace <span style="color: #8b2252;">\</span>
         --strictkey <span style="color: #8b2252;">\</span>
         --finalcomma <span style="color: #8b2252;">\</span>
         --brackets <span style="color: #8b2252;">\</span>
         --no-latex <span style="color: #8b2252;">\</span>
         ::: *xml &gt; /tmp/east-bibs.bib
</pre>
</div>
</div>
</div>


<div id="outline-container-org046315f" class="outline-3">
<h3 id="org046315f"><span class="section-number-3">4.2</span> biblatex -&gt; MODS</h3>
<div class="outline-text-3" id="text-4-2">
<div class="org-src-container">
<pre class="src src-bash">parallel biblatex2xml <span style="color: #8b2252;">\</span>
         --input-encoding unicode <span style="color: #8b2252;">\</span>
         --unicode-characters <span style="color: #8b2252;">\</span>
         --unicode-no-bom <span style="color: #8b2252;">\</span>
         --no-latex <span style="color: #8b2252;">\</span>
         ::: *.bib &gt; /tmp/east-bibs.mods
</pre>
</div>
</div>
</div>
</div>


<div id="outline-container-org1c734a9" class="outline-2">
<h2 id="org1c734a9"><span class="section-number-2">5</span> Database/Django commands</h2>
<div class="outline-text-2" id="text-5">
<p>
To generate initial data from what’s in the Django backend, do
something like this:
</p>

<div class="org-src-container">
<pre class="src src-python"><span style="color: #a020f0;">import</span> os
<span style="color: #a020f0;">import</span> shutil
<span style="color: #a020f0;">from</span> biblio.models <span style="color: #a020f0;">import</span> BibliographicEntry
<span style="color: #a020f0;">from</span> biblio.stuff <span style="color: #a020f0;">import</span> *
<span style="color: #a020f0;">from</span> django.utils.text <span style="color: #a020f0;">import</span> slugify
<span style="color: #a020f0;">from</span> lxml <span style="color: #a020f0;">import</span> etree

<span style="color: #a0522d;">outdir</span> = <span style="color: #8b2252;">"/tmp/east-biblio-exports"</span>

<span style="color: #a020f0;">if</span> os.path.exists(outdir):
    shutil.rmtree(outdir)

os.makedirs(outdir)

<span style="color: #a020f0;">def</span> <span style="color: #0000ff;">write_bibs</span>(bibs, subdir):
    <span style="color: #8b2252;">"""Write useful formats (mods, source, bib) of every bib in bibs (a</span>
<span style="color: #8b2252;">query object) into outputdir/subdir."""</span>
    <span style="color: #a0522d;">suboutdir</span> = os.path.join(outdir, subdir)

    <span style="color: #a020f0;">if</span> os.path.exists(suboutdir):
        shutil.rmtree(suboutdir)
    os.makedirs(suboutdir)


    <span style="color: #a020f0;">for</span> bib <span style="color: #a020f0;">in</span> bibs:
        <span style="color: #a0522d;">basename</span> = <span style="color: #8b2252;">"%s__%s"</span> % (bib.<span style="color: #483d8b;">id</span>,
                               slugify(bib.pretty_short)[:40])
        <span style="color: #a0522d;">modsoutfile</span> = <span style="color: #483d8b;">open</span>(
            os.path.join(suboutdir,
                         <span style="color: #8b2252;">"%s.mods.xml"</span> % (basename)),
            <span style="color: #8b2252;">"w"</span>)

        <span style="color: #a020f0;">print</span>(<span style="color: #8b2252;">"Writing %s"</span> % modsoutfile)
        modsoutfile.write(
            etree.tostring(
                etree.fromstring(bib.get_mods()),
                encoding=<span style="color: #483d8b;">str</span>,
                pretty_print=<span style="color: #008b8b;">True</span>
            ))
        modsoutfile.close()

        <span style="color: #a0522d;">biboutfile</span> = <span style="color: #483d8b;">open</span>(
            os.path.join(suboutdir,
                         <span style="color: #8b2252;">"%s.bib"</span> % (basename)),
            <span style="color: #8b2252;">"w"</span>)

        <span style="color: #a020f0;">print</span>(<span style="color: #8b2252;">"Writing %s"</span> % biboutfile)
        biboutfile.write(bib.get_bibtex(putids=<span style="color: #008b8b;">True</span>))
        biboutfile.close()

        <span style="color: #a0522d;">sourceoutfile</span> = <span style="color: #483d8b;">open</span>(
            os.path.join(suboutdir,
                         <span style="color: #8b2252;">"%s.src"</span> % (basename)),
            <span style="color: #8b2252;">"w"</span>)
        <span style="color: #a020f0;">print</span>(<span style="color: #8b2252;">"Writing %s"</span> % sourceoutfile)
        sourceoutfile.write(bib.source)
        sourceoutfile.close()



write_bibs(BibliographicEntry.objects.<span style="color: #483d8b;">filter</span>(repository=<span style="color: #8b2252;">"TAMB"</span>), <span style="color: #8b2252;">"tamboti"</span>)
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Patrick McAllister (pma@rdorte.org)</p>
<p class="date">Created: 2019-07-25 Thu 15:14</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
